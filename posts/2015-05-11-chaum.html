<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" class="wf-loading"><head>
       <script src="https://use.typekit.net/geg0pqq.js"></script><script>
        (function(d) {
          var config = {
            kitId: 'geg0pqq',
            scriptTimeout: 3000,
            async: true
          },
          h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
        })(document);
    </script>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dog Fur Donuts</title>
    <!--
     <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                displayAlign: "left",
                showProcessingMessages: false,
                showMathMenu: true,
                messageStyle: "none",
                TeX: { TagSide: "left", equationNumbers: { autoNumber: "AMS" } }
            });
        </script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
        </script>
        -->
   <link rel="stylesheet" type="text/css" href="../css/tufte.css"><style type="text/css">.tk-minion-pro-caption{font-family:"minion-pro-caption",sans-serif;}.tk-minion-pro-display{font-family:"minion-pro-display",serif;}</style><link rel="stylesheet" href="https://use.typekit.net/c/855fba/1w;minion-pro-caption,7ceb210e49ade74e23101e10f006f110a0b6588c7c57777a6e3d98a38b749696,bzc:W:i4,bzb:W:n4,bzj:W:n7;minion-pro-display,7ceb210e49ade74e23101e10f006f110a0b6588c7c57777a6e3d98a38b749696,c0F:W:i4,c0J:W:n4,c0C:W:n7/k" media="all">
  </head>

  <body><style id="MathJax_CHTML_styles">.mjx-chtml {display: inline-block; line-height: 0; text-indent: 0; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; margin: 0; padding: 1px 0}
.MJXc-display {display: block; text-align: center; margin: 1em 0; padding: 0}
.mjx-chtml[tabindex]:focus, body :focus .mjx-chtml[tabindex] {display: inline-table}
.mjx-math {display: inline-block; border-collapse: separate; border-spacing: 0}
.mjx-math * {display: inline-block; text-align: left}
.mjx-numerator {display: block; text-align: center}
.mjx-denominator {display: block; text-align: center}
.MJXc-stacked {height: 0; position: relative}
.MJXc-stacked > * {position: absolute}
.MJXc-bevelled > * {display: inline-block}
.mjx-stack {display: inline-block}
.mjx-op {display: block}
.mjx-under {display: table-cell}
.mjx-over {display: block}
.mjx-over > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-under > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-stack > .mjx-sup {display: block}
.mjx-stack > .mjx-sub {display: block}
.mjx-prestack > .mjx-presup {display: block}
.mjx-prestack > .mjx-presub {display: block}
.mjx-delim-h > .mjx-char {display: inline-block}
.mjx-surd {vertical-align: top}
.mjx-mphantom * {visibility: hidden}
.mjx-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 2px 3px; font-style: normal; font-size: 90%}
.mjx-annotation-xml {line-height: normal}
.mjx-menclose > svg {fill: none; stroke: currentColor}
.mjx-mtr {display: table-row}
.mjx-mlabeledtr {display: table-row}
.mjx-mtd {display: table-cell; text-align: center}
.mjx-label {display: block}
.mjx-box {display: inline-block}
.mjx-block {display: block}
.mjx-span {display: span}
.mjx-char {display: block; white-space: pre}
.mjx-itable {display: inline-table}
.mjx-row {display: table-row}
.mjx-cell {display: table-cell}
.mjx-table {display: table; width: 100%}
.mjx-line {display: block; height: 0}
.mjx-strut {width: 0; padding-top: 1em}
.mjx-vsize {width: 0}
.MJXc-space1 {margin-left: .167em}
.MJXc-space2 {margin-left: .222em}
.MJXc-space3 {margin-left: .278em}
.mjx-ex-box-test {position: absolute; width: 1px; height: 60ex}
.MJXc-TeX-unknown-R {font-family: monospace; font-style: normal; font-weight: normal}
.MJXc-TeX-unknown-I {font-family: monospace; font-style: italic; font-weight: normal}
.MJXc-TeX-unknown-B {font-family: monospace; font-style: normal; font-weight: bold}
.MJXc-TeX-unknown-BI {font-family: monospace; font-style: italic; font-weight: bold}
.MJXc-TeX-ams-R {font-family: MJXc-TeX-ams-R,MJXc-TeX-ams-Rw}
.MJXc-TeX-cal-B {font-family: MJXc-TeX-cal-B,MJXc-TeX-cal-Bx,MJXc-TeX-cal-Bw}
.MJXc-TeX-frak-R {font-family: MJXc-TeX-frak-R,MJXc-TeX-frak-Rw}
.MJXc-TeX-frak-B {font-family: MJXc-TeX-frak-B,MJXc-TeX-frak-Bx,MJXc-TeX-frak-Bw}
.MJXc-TeX-math-BI {font-family: MJXc-TeX-math-BI,MJXc-TeX-math-BIx,MJXc-TeX-math-BIw}
.MJXc-TeX-sans-R {font-family: MJXc-TeX-sans-R,MJXc-TeX-sans-Rw}
.MJXc-TeX-sans-B {font-family: MJXc-TeX-sans-B,MJXc-TeX-sans-Bx,MJXc-TeX-sans-Bw}
.MJXc-TeX-sans-I {font-family: MJXc-TeX-sans-I,MJXc-TeX-sans-Ix,MJXc-TeX-sans-Iw}
.MJXc-TeX-script-R {font-family: MJXc-TeX-script-R,MJXc-TeX-script-Rw}
.MJXc-TeX-type-R {font-family: MJXc-TeX-type-R,MJXc-TeX-type-Rw}
.MJXc-TeX-cal-R {font-family: MJXc-TeX-cal-R,MJXc-TeX-cal-Rw}
.MJXc-TeX-main-B {font-family: MJXc-TeX-main-B,MJXc-TeX-main-Bx,MJXc-TeX-main-Bw}
.MJXc-TeX-main-I {font-family: MJXc-TeX-main-I,MJXc-TeX-main-Ix,MJXc-TeX-main-Iw}
.MJXc-TeX-main-R {font-family: MJXc-TeX-main-R,MJXc-TeX-main-Rw}
.MJXc-TeX-math-I {font-family: MJXc-TeX-math-I,MJXc-TeX-math-Ix,MJXc-TeX-math-Iw}
.MJXc-TeX-size1-R {font-family: MJXc-TeX-size1-R,MJXc-TeX-size1-Rw}
.MJXc-TeX-size2-R {font-family: MJXc-TeX-size2-R,MJXc-TeX-size2-Rw}
.MJXc-TeX-size3-R {font-family: MJXc-TeX-size3-R,MJXc-TeX-size3-Rw}
.MJXc-TeX-size4-R {font-family: MJXc-TeX-size4-R,MJXc-TeX-size4-Rw}
@font-face {font-family: MJXc-TeX-ams-R; src: local('MathJax_AMS'), local('MathJax_AMS-Regular')}
@font-face {font-family: MJXc-TeX-ams-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_AMS-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-B; src: local('MathJax_Caligraphic Bold'), local('MathJax_Caligraphic-Bold')}
@font-face {font-family: MJXc-TeX-cal-Bx; src: local('MathJax_Caligraphic'); font-weight: bold}
@font-face {font-family: MJXc-TeX-cal-Bw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Bold.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Bold.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-R; src: local('MathJax_Fraktur'), local('MathJax_Fraktur-Regular')}
@font-face {font-family: MJXc-TeX-frak-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-B; src: local('MathJax_Fraktur Bold'), local('MathJax_Fraktur-Bold')}
@font-face {font-family: MJXc-TeX-frak-Bx; src: local('MathJax_Fraktur'); font-weight: bold}
@font-face {font-family: MJXc-TeX-frak-Bw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Bold.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Bold.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-BI; src: local('MathJax_Math BoldItalic'), local('MathJax_Math-BoldItalic')}
@font-face {font-family: MJXc-TeX-math-BIx; src: local('MathJax_Math'); font-weight: bold; font-style: italic}
@font-face {font-family: MJXc-TeX-math-BIw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Math-BoldItalic.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-R; src: local('MathJax_SansSerif'), local('MathJax_SansSerif-Regular')}
@font-face {font-family: MJXc-TeX-sans-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-B; src: local('MathJax_SansSerif Bold'), local('MathJax_SansSerif-Bold')}
@font-face {font-family: MJXc-TeX-sans-Bx; src: local('MathJax_SansSerif'); font-weight: bold}
@font-face {font-family: MJXc-TeX-sans-Bw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Bold.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Bold.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-I; src: local('MathJax_SansSerif Italic'), local('MathJax_SansSerif-Italic')}
@font-face {font-family: MJXc-TeX-sans-Ix; src: local('MathJax_SansSerif'); font-style: italic}
@font-face {font-family: MJXc-TeX-sans-Iw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Italic.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-script-R; src: local('MathJax_Script'), local('MathJax_Script-Regular')}
@font-face {font-family: MJXc-TeX-script-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Script-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-type-R; src: local('MathJax_Typewriter'), local('MathJax_Typewriter-Regular')}
@font-face {font-family: MJXc-TeX-type-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Typewriter-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Typewriter-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Typewriter-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-R; src: local('MathJax_Caligraphic'), local('MathJax_Caligraphic-Regular')}
@font-face {font-family: MJXc-TeX-cal-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-B; src: local('MathJax_Main Bold'), local('MathJax_Main-Bold')}
@font-face {font-family: MJXc-TeX-main-Bx; src: local('MathJax_Main'); font-weight: bold}
@font-face {font-family: MJXc-TeX-main-Bw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Bold.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-I; src: local('MathJax_Main Italic'), local('MathJax_Main-Italic')}
@font-face {font-family: MJXc-TeX-main-Ix; src: local('MathJax_Main'); font-style: italic}
@font-face {font-family: MJXc-TeX-main-Iw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Italic.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-R; src: local('MathJax_Main'), local('MathJax_Main-Regular')}
@font-face {font-family: MJXc-TeX-main-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-I; src: local('MathJax_Math Italic'), local('MathJax_Math-Italic')}
@font-face {font-family: MJXc-TeX-math-Ix; src: local('MathJax_Math'); font-style: italic}
@font-face {font-family: MJXc-TeX-math-Iw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size1-R; src: local('MathJax_Size1'), local('MathJax_Size1-Regular')}
@font-face {font-family: MJXc-TeX-size1-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Size1-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size2-R; src: local('MathJax_Size2'), local('MathJax_Size2-Regular')}
@font-face {font-family: MJXc-TeX-size2-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Size2-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size3-R; src: local('MathJax_Size3'), local('MathJax_Size3-Regular')}
@font-face {font-family: MJXc-TeX-size3-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Size3-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size4-R; src: local('MathJax_Size4'), local('MathJax_Size4-Regular')}
@font-face {font-family: MJXc-TeX-size4-Rw; src /*1*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Size4-Regular.eot'); src /*2*/: url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('https://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
</style>
    <main role="main">
    <article class="row article post" role="article">
      <div class="cell">
        <header class="row">
          <div class="home">
            <a href="../">Blog</a>
            <a href="../archive.html">Archive</a>
            <a href="../projects.html">Projects</a>
          </div>
        </header>
          <h1 class="preview-title">Dog Fur Donuts</h1> 
<div class="preview-info">

  Part I of the series <i>Diffie-Hellman key exchange</i>.

<div><i>May 11, 2015</i></div>
</div>
<p>

</p><h2 id="perfectly-secure">Perfectly Secure</h2>
<p>“I have it!”, Alice yells out to anyone who can hear her. Donuts are stacked precariously around her, gleaming in the fluorescents of her parents’ kitchen. She feels like a giant in a confectionery skyline. Which is what she wants, really. Her donut stand is about to pay for a new TV for the living room, entitling her to watch an entire season of <em>House of Cards</em>. Dad had <em>promised</em>.</p>
<div class="figure">
<img src="../images/alice.png" alt="Figure 1 · Alice, eight year-old donut prodigy.">
<p class="caption"><em>Figure 1</em> · Alice, eight year-old donut prodigy.</p>
</div>
<p>Alice holds her wooden spoon aloft, victorious. She’s just created the most delicious donut her neighborhood will ever taste. But first, she’s got to check with her best friend, Bob, who <em>really</em> knows donuts…</p>
<p>The spoon lowers as she remembers Bob’s sister, Eve, a teenage brat who steals all of Alice’s recipes and posts them on a recipe site, where they are Five Starred and accrue glowing comments<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. Alice has tried to use codewords for ingredients, or writing in really tiny letters, but somehow the recipes keep popping up online, just a few hours after Alice sends the recipe to Bob.</p>
<p><em>No way it’s happening to this recipe,</em> Alice thinks. She needs a secure way to send her recipe to Bob, so that even if Eve intercepts <em>everything</em> Alice sends, Eve won’t be able to make any sense of it.</p>
<p>Alice brings up Google and slowly types her search query: <em>perfect encryption</em>.</p>
<!--more-->
<h2 id="a-short-aside-on-one-time-pads">A short aside on one-time pads</h2>
<p>A one-time pad provides perfect security. It’s the only known encryption method that has an information-theoretic guarantee of unbreakability.</p>
<p>To perform one-time pad encryption, we need a plaintext (the message we want to encrypt), and a random key that’s at least as long as the plaintext. We then combine the key with the plaintext using modular addition<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> to produce a ciphertext, which we send to a recipient. The recipient must have a copy of the key, which they’ll use to reverse the encryption and obtain the plaintext.</p>
<p>We use modular addition in one-time pad encryption because it produces ciphertexts that have the same randomness as the key used to generate it. We call this property of modular addition <em>randomness preserving</em><a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>. If you produce an <span id="MathJax-Element-1-Frame" class="mjx-chtml"><span id="MJXc-Node-483" class="mjx-math" role="math"><span id="MJXc-Node-484" class="mjx-mrow"><span id="MJXc-Node-485" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span>-bit ciphertext with a randomness preserving one-time pad function, and then give the ciphertext to someone who doesn’t know the key, to them, it’ll look equally likely to have been generated from <em>any</em> <span id="MathJax-Element-2-Frame" class="mjx-chtml"><span id="MJXc-Node-486" class="mjx-math" role="math"><span id="MJXc-Node-487" class="mjx-mrow"><span id="MJXc-Node-488" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span>-bit string. The ciphertext <code>dazfdooefldgsk</code> could be encoding <code>password123456</code> or <code>bbbbbbbbbbbbbb</code> or <code>strike at dawn</code> or any other possible permutation of 14 characters, and it’s <em>provably</em> impossible to distinguish between these possibilities without knowing the key.</p>
<h2 id="dog-fur-donuts">Dog Fur Donuts</h2>
<p>“Heads.”</p>
<p>“Heads.”</p>
<p>“Tails.”</p>
<p>Alice is four pages into generating her random one-time pad, and she’s feeling pretty smug as she imagines Eve trying to decode her recipe, trying key after key, growing older and more withered, until finally Eve hits a donut recipe, but it turns out to be the recipe for, say, Smelly Sock and Dog Fur Donuts, a definite un-Five-Star-Worthy recipe that will garner a few amused comments, at best.</p>
<p>“Heads.”</p>
<p>“Tails.”</p>
<p>“Wait a minute…”</p>
<p>Alice stops writing down the coin flips, staring at the four pages of <code>HHHTTTHTHTTTHTHTHHTHTHTHTHTHTTHTH</code> she had neatly inscribed.</p>
<p>If Eve has managed to intercept every recipe she’s sent to Bob, <em>what’s to stop her from intercepting this key too?</em> If Eve has the key, Alice may as well post the recipe online herself, for all the good the encryption is going to do.</p>
<p>Maybe- maybe she could encrypt the key before she sends it, but then of course she’d need to send Bob <em>another</em> key to decrypt the first key, and her recipe would be posted online before the first batch came out of the deep fryer.</p>
<p>Alice puts away the coins, carefully stacks up the pages, and begins to think.</p>
<h2 id="perfectly-useless">Perfectly useless</h2>
<p>Despite its perfect security, the classic one-time pad is exquisitely impractical. A one-time pad key can never be reused<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>, because key reuse makes ciphertexts vulnerable to standard cryptanalysis, nullifying their pefect security guarantee. This means we need to securely send an <span id="MathJax-Element-3-Frame" class="mjx-chtml"><span id="MJXc-Node-489" class="mjx-math" role="math"><span id="MJXc-Node-490" class="mjx-mrow"><span id="MJXc-Node-491" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span>-bit key to securely send an <span id="MathJax-Element-4-Frame" class="mjx-chtml"><span id="MJXc-Node-492" class="mjx-math" role="math"><span id="MJXc-Node-493" class="mjx-mrow"><span id="MJXc-Node-494" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span>-bit message. If the key is intercepted, the ciphertext can be trivally decrypted- thus, the security of the one-time pad is equivalent to the security of the method used to transmit the key! If the transmission method isn’t secure, the one-time pad isn’t secure either, and if the method <em>is</em> secure, why not just use that method to transmit the plaintext itself? It seems like one-time pad encryption just passes the cryptocurrency-denominated buck to the key transmission method.</p>
<p>Fortunately, Diffie-Hellman is a smarter type of key transmission, one that’s eager to accept said buck, and allows us to solve the key transmission problem without actually transmitting the key proper.</p>
<h2 id="the-idea">The Idea</h2>
<p>Using a one-time pad doesn’t require Bob to have Alice’s key- they just need the <em>same</em> key, and it was this realisation that led Alice to her Idea. Sure, the Idea was incomplete and quite possibly a waste of time, but hey, she’d just spent two hours flipping some coins.</p>
<p>Alice’s reasoning went like this: Eve seemed like she could intercept everything Alice sent Bob. But what if Alice and Bob each had a private secret, that they would <em>never</em> send to each other. All the five-stars in the world wouldn’t let Eve intercept what they <em>don’t</em> send.</p>
<p>They could then send something to each other that they could each combine with their private secret, and somehow<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a> they would arrive at the same key, without ever having sent that key to each other. Alice grabbed a piece of paper and started sketching out the Idea:</p>
<p>Then, at the very bottom, Alice writes: <span id="MathJax-Element-5-Frame" class="mjx-chtml"><span id="MJXc-Node-495" class="mjx-math" role="math"><span id="MJXc-Node-496" class="mjx-mrow"><span id="MJXc-Node-497" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">A</span></span><span id="MJXc-Node-498" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-499" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span><span id="MJXc-Node-500" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-501" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">B</span></span><span id="MJXc-Node-502" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-503" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span></span></p>
<p>What could that serve as that operation, <span id="MathJax-Element-6-Frame" class="mjx-chtml"><span id="MJXc-Node-504" class="mjx-math" role="math"><span id="MJXc-Node-505" class="mjx-mrow"><span id="MJXc-Node-506" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span></span></span></span>, that would allow that equation to be satisfied? What kind of data was <span id="MathJax-Element-7-Frame" class="mjx-chtml"><span id="MJXc-Node-507" class="mjx-math" role="math"><span id="MJXc-Node-508" class="mjx-mrow"><span id="MJXc-Node-509" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">A</span></span></span></span></span> and <span id="MathJax-Element-8-Frame" class="mjx-chtml"><span id="MJXc-Node-510" class="mjx-math" role="math"><span id="MJXc-Node-511" class="mjx-mrow"><span id="MJXc-Node-512" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">B</span></span></span></span></span> and <span id="MathJax-Element-9-Frame" class="mjx-chtml"><span id="MJXc-Node-513" class="mjx-math" role="math"><span id="MJXc-Node-514" class="mjx-mrow"><span id="MJXc-Node-515" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span></span> and <span id="MathJax-Element-10-Frame" class="mjx-chtml"><span id="MJXc-Node-516" class="mjx-math" role="math"><span id="MJXc-Node-517" class="mjx-mrow"><span id="MJXc-Node-518" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span></span></span>, and how did they relate? There were so many gaps in the scheme, but at least Alice felt like she was making progress. And she had a friend who might be able to help her.</p>
<h2 id="diffie-hellman">Diffie-Hellman</h2>
<p>Alice has unwittingly sketched out a skeletal framework for Diffie-Hellman key exchange. Here’s how it should work:</p>
<ol style="list-style-type: decimal">
<li>Alice and Bob each choose a <em>private key</em>, which they never tell anyone.</li>
<li>Alice and Bob each calculate a <em>public key</em> from their private key.</li>
<li>Alice and Bob exchange their public keys. It doesn’t matter if anyone intercepts the public keys- they’re public, after all.</li>
<li>Alice and Bob each combine their own private key with their counterpart’s public key, to arrive at a <em>shared key</em>.</li>
<li>Through the magic of Diffie-Hellman, they calculate exactly the same shared key!</li>
</ol>
<h2 id="yvonne">Yvonne</h2>
<p>Alice decides to visit her friend, Yvonne, who has this habit of getting full marks in every math test, and yet somehow managing to seem modest about the way she did not, in fact, have to try at all, what with math coming as naturally to her as walking did to Alice.</p>
<p>Alice explains the Idea to Yvonee, who looks at Alice’s equation, and tells her that it’s all quite simple really, you just need to use <em>integer addition</em><a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a> and the Idea will work.</p>
<p>So the Idea works! Alice wants to try it out right away, so they begin to work out the details.</p>
<p>For their secret, Yvonne explains, they should each pick a random number between 1 and 100. They keep this number a secret. It’s their <em>private key</em>. But they can calculate their <em>public key</em> if they each add the same arbitrary number- the <em>group parameter</em>- to their private key. Yvonne picks 23, because she likes that number. They eventually sketch this out:</p>
<p>This is great- they’ve arrived at a shared key- 109- without ever sending their private keys over the wire! If Eve wanted to decrypt their transmissions, Yvonne explains, Eve would need to solve the <em>addition inverse problem</em>, also known as <em>subtraction</em>, to recover the private keys, and thereby calculate the shared key.</p>
<p>“But…” Alice is unsure if she’s being stupid.</p>
<p>“But what?”</p>
<p>“Isn’t subtraction… really easy? I mean, even <em>I</em> could do it in first grade, and I’m not a Certified Math Genius like you.”</p>
<h2 id="symmetry-breaking">Symmetry Breaking</h2>
<p>Alice is right: the <em>addition inverse problem</em> isn’t very difficult. When Alice tells Bob that the group parameter is 23, Eve will just intercept it, along with Alice’s public key, and then she can just calculate Alice’s private key by computing 75 - 23 = 52.<br>
They could try to make the <em>addition inverse problem</em> more difficult by picking really large numbers, but then it would take as much effort to encrypt the message as Eve would take to calculate the private key from the public key and group parameter.<br>
Using integer addition really does let us reach a shared key, however, so it’s probably worthwhile figuring out why it works, before we try to beef up the security.</p>
<p>Alice had the equation:</p>
<p><span class="math display"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-11-Frame" class="mjx-chtml"><span id="MJXc-Node-519" class="mjx-math" role="math"><span id="MJXc-Node-520" class="mjx-mrow"><span id="MJXc-Node-521" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">A</span></span><span id="MJXc-Node-522" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-523" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span><span id="MJXc-Node-524" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-525" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">B</span></span><span id="MJXc-Node-526" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-527" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span></span></span></span></p>
<p>The capital letters are the public keys, and the lowercase letters are the private keys. We generate public keys from private keys by combining them with the group parameter<a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a>. Let’s substitute this into <span id="MathJax-Element-12-Frame" class="mjx-chtml"><span id="MJXc-Node-528" class="mjx-math" role="math"><span id="MJXc-Node-529" class="mjx-mrow"><span id="MJXc-Node-530" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-531" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span><span id="MJXc-Node-532" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span>:</p>
<p><span class="math display"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-13-Frame" class="mjx-chtml"><span id="MJXc-Node-533" class="mjx-math" role="math"><span id="MJXc-Node-534" class="mjx-mrow"><span id="MJXc-Node-535" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-536" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span id="MJXc-Node-537" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-538" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-539" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span><span id="MJXc-Node-540" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-541" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span><span id="MJXc-Node-542" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-543" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-544" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span><span id="MJXc-Node-545" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-546" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-547" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span><span id="MJXc-Node-548" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-549" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span></span></span></span></p>
<p>Yvonne knew that integer addition would work here. If we write:</p>
<p><span class="math display"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-14-Frame" class="mjx-chtml"><span id="MJXc-Node-550" class="mjx-math" role="math"><span id="MJXc-Node-551" class="mjx-mrow"><span id="MJXc-Node-552" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-553" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span id="MJXc-Node-554" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span id="MJXc-Node-555" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-556" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span><span id="MJXc-Node-557" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span id="MJXc-Node-558" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span><span id="MJXc-Node-559" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-560" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-561" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span><span id="MJXc-Node-562" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span id="MJXc-Node-563" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-564" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span><span id="MJXc-Node-565" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span id="MJXc-Node-566" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span></span></span></span></p>
<p>…we can see that’s obviously true. But what properties of addition let it substitute for <span id="MathJax-Element-15-Frame" class="mjx-chtml"><span id="MJXc-Node-567" class="mjx-math" role="math"><span id="MJXc-Node-568" class="mjx-mrow"><span id="MJXc-Node-569" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span></span></span></span>? Put another way, what’s the minimum we can assume about <span id="MathJax-Element-16-Frame" class="mjx-chtml"><span id="MJXc-Node-570" class="mjx-math" role="math"><span id="MJXc-Node-571" class="mjx-mrow"><span id="MJXc-Node-572" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span></span></span></span> to ensure that <span id="MathJax-Element-17-Frame" class="mjx-chtml"><span id="MJXc-Node-573" class="mjx-math" role="math"><span id="MJXc-Node-574" class="mjx-mrow"><span id="MJXc-Node-575" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-576" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span><span id="MJXc-Node-577" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span> holds?</p>
<p>Let’s start with associativity<a href="#fn8" class="footnoteRef" id="fnref8"><sup>8</sup></a>. If we assume that <span id="MathJax-Element-18-Frame" class="mjx-chtml"><span id="MJXc-Node-578" class="mjx-math" role="math"><span id="MJXc-Node-579" class="mjx-mrow"><span id="MJXc-Node-580" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span></span></span></span> is associative, we can drop the brackets from <span id="MathJax-Element-19-Frame" class="mjx-chtml"><span id="MJXc-Node-581" class="mjx-math" role="math"><span id="MJXc-Node-582" class="mjx-mrow"><span id="MJXc-Node-583" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-584" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span><span id="MJXc-Node-585" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span>, and we get:</p>
<p><span class="math display"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-20-Frame" class="mjx-chtml"><span id="MJXc-Node-586" class="mjx-math" role="math"><span id="MJXc-Node-587" class="mjx-mrow"><span id="MJXc-Node-588" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span id="MJXc-Node-589" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-590" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-591" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-592" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span><span id="MJXc-Node-593" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-594" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span><span id="MJXc-Node-595" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-596" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-597" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-598" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span></span></span></span></p>
<p>Look at that! Now the only difference between the two sides is the order of the terms. If we assume that <span id="MathJax-Element-21-Frame" class="mjx-chtml"><span id="MJXc-Node-599" class="mjx-math" role="math"><span id="MJXc-Node-600" class="mjx-mrow"><span id="MJXc-Node-601" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span></span></span></span> is commutative<a href="#fn9" class="footnoteRef" id="fnref9"><sup>9</sup></a>, we can rearrange the order of the terms however we like:</p>
<p><span class="math display"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-22-Frame" class="mjx-chtml"><span id="MJXc-Node-602" class="mjx-math" role="math"><span id="MJXc-Node-603" class="mjx-mrow"><span id="MJXc-Node-604" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span id="MJXc-Node-605" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-606" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-607" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-608" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span><span id="MJXc-Node-609" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-610" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span><span id="MJXc-Node-611" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-612" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-613" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-614" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span></span></span></span></span></p>
<p>…and that’s obviously true.</p>
<p>Now we know that if we have an operation that’s commutative and associative, it can be successfully used in Alice’s scheme to arrive at a shared key. Integer addition has those two properties, but it’s about as computationally intensive to add as it is to subtract. This means that breaking a message’s encryption would take around the same amount of time as encrypting the message in the first place!</p>
<p>What Alice is really looking for is an operation that has three properties: commutativity, associativity, and computational asymmetry. Of course, Yvonne already knows all this, and has another idea for what to use as the <span id="MathJax-Element-23-Frame" class="mjx-chtml"><span id="MJXc-Node-615" class="mjx-math" role="math"><span id="MJXc-Node-616" class="mjx-mrow"><span id="MJXc-Node-617" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span></span></span></span> operator.</p>
<h2 id="another-operation">Another Operation</h2>
<p>“So… Eve knows how to do subtraction,” Yvonne says, sounding slightly surprised.</p>
<p>Alice isn’t sure whether she has a particularly low opinion of Eve, or just a really poorly calibrated sense of other people’s abilities. She doesn’t ask.</p>
<p>“Is there another operation we can use, apart from integer addition? Something that we can easily calculate, but isn’t so easy to reverse?”</p>
<p>Yvonne thinks for a while.</p>
<p>“Commutativity, associativity, and computational asymmetry,” she says.</p>
<p>Alice knows Yvonne is thinking aloud, so she just waits.</p>
<p>“Modular exponentiation<a href="#fn10" class="footnoteRef" id="fnref10"><sup>10</sup></a>,” Yvonne finally says.</p>
<p>Alice grabs some paper and they start working through the protocol again.</p>
<p>It works! Alice is worried that Yvonne is underestimating Eve’s abilities again, though.</p>
<p>“Couldn’t Eve just solve for <span id="MathJax-Element-24-Frame" class="mjx-chtml"><span id="MJXc-Node-618" class="mjx-math" role="math"><span id="MJXc-Node-619" class="mjx-mrow"><span id="MJXc-Node-620" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span></span> in <span id="MathJax-Element-25-Frame" class="mjx-chtml"><span id="MJXc-Node-621" class="mjx-math" role="math"><span id="MJXc-Node-622" class="mjx-mrow"><span id="MJXc-Node-623" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-624" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-625" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span><span id="MJXc-Node-626" class="mjx-TeXmathchoice"><span id="MJXc-Node-627" class="mjx-mspace" style="width: 0.444em; height: 0px;"></span></span><span id="MJXc-Node-628" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-629" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">mod</span></span><span id="MJXc-Node-630" class="mjx-mspace" style="width: 0.333em; height: 0px;"></span><span id="MJXc-Node-631" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1117</span></span><span id="MJXc-Node-632" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span><span id="MJXc-Node-633" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-634" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1055</span></span></span></span></span>, and work out my private key?”</p>
<h2 id="the-problem">The Problem</h2>
<p>As it turns out, the <span id="MathJax-Element-26-Frame" class="mjx-chtml"><span id="MJXc-Node-635" class="mjx-math" role="math"><span id="MJXc-Node-636" class="mjx-mrow"><span id="MJXc-Node-637" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span></span> in <span id="MathJax-Element-27-Frame" class="mjx-chtml"><span id="MJXc-Node-638" class="mjx-math" role="math"><span id="MJXc-Node-639" class="mjx-mrow"><span id="MJXc-Node-640" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-641" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.076em; padding-right: 0.071em;"><span id="MJXc-Node-642" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span><span id="MJXc-Node-643" class="mjx-TeXmathchoice"><span id="MJXc-Node-644" class="mjx-mspace" style="width: 0.444em; height: 0px;"></span></span><span id="MJXc-Node-645" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-646" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">mod</span></span><span id="MJXc-Node-647" class="mjx-mspace" style="width: 0.333em; height: 0px;"></span><span id="MJXc-Node-648" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span id="MJXc-Node-649" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span>, is known as the discrete logarithm. Calculating <span id="MathJax-Element-28-Frame" class="mjx-chtml"><span id="MJXc-Node-650" class="mjx-math" role="math"><span id="MJXc-Node-651" class="mjx-mrow"><span id="MJXc-Node-652" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span></span>, given <span id="MathJax-Element-29-Frame" class="mjx-chtml"><span id="MJXc-Node-653" class="mjx-math" role="math"><span id="MJXc-Node-654" class="mjx-mrow"><span id="MJXc-Node-655" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span></span></span></span> and <span id="MathJax-Element-30-Frame" class="mjx-chtml"><span id="MJXc-Node-656" class="mjx-math" role="math"><span id="MJXc-Node-657" class="mjx-mrow"><span id="MJXc-Node-658" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span></span></span></span>, is the best known way to defeat Diffie-Hellman. Fortunately, there’s no known polynomial-time algorithm for calculating discrete logarithms- finding such an algorithm is known as the <em>discrete logarithm problem</em>, and it’s an unsolved problem in computer science.</p>
<p>Some people suspect that efficient non-quantum<a href="#fn11" class="footnoteRef" id="fnref11"><sup>11</sup></a> algorithms exist, but until or unless one is discovered, Alice can simply pick a key size that is far too large to be brute-forced, and Eve will never get her hands on that donut recipe.</p>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p><em>Amazing donuts! I used to get these from a little donut stand down the road, but now I’ll never return! Five Stars!</em><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>XOR can be thought of as a special case of modular addition.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>An easy way to get an intuition for why modular addition is randomness preserving is to imagine that I’ve got two numbers between one and ten, <span id="MathJax-Element-31-Frame" class="mjx-chtml"><span id="MJXc-Node-659" class="mjx-math" role="math"><span id="MJXc-Node-660" class="mjx-mrow"><span id="MJXc-Node-661" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span> and <span id="MathJax-Element-32-Frame" class="mjx-chtml"><span id="MJXc-Node-662" class="mjx-math" role="math"><span id="MJXc-Node-663" class="mjx-mrow"><span id="MJXc-Node-664" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span>, where <span id="MathJax-Element-33-Frame" class="mjx-chtml"><span id="MJXc-Node-665" class="mjx-math" role="math"><span id="MJXc-Node-666" class="mjx-mrow"><span id="MJXc-Node-667" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span> is a number I’ve picked, and <span id="MathJax-Element-34-Frame" class="mjx-chtml"><span id="MJXc-Node-668" class="mjx-math" role="math"><span id="MJXc-Node-669" class="mjx-mrow"><span id="MJXc-Node-670" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span> is a random number. I then calculate <span class="math display"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-35-Frame" class="mjx-chtml"><span id="MJXc-Node-671" class="mjx-math" role="math"><span id="MJXc-Node-672" class="mjx-mrow"><span id="MJXc-Node-673" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span id="MJXc-Node-674" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span id="MJXc-Node-675" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span id="MJXc-Node-676" class="mjx-TeXmathchoice"><span id="MJXc-Node-677" class="mjx-mspace" style="width: 1em; height: 0px;"></span></span><span id="MJXc-Node-678" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-679" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">mod</span></span><span id="MJXc-Node-680" class="mjx-mspace" style="width: 0.333em; height: 0px;"></span><span id="MJXc-Node-681" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">10</span></span><span id="MJXc-Node-682" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span><span id="MJXc-Node-683" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.298em;">≡</span></span><span id="MJXc-Node-684" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">r</span></span></span></span></span></span></span> and tell you that <span id="MathJax-Element-36-Frame" class="mjx-chtml"><span id="MJXc-Node-685" class="mjx-math" role="math"><span id="MJXc-Node-686" class="mjx-mrow"><span id="MJXc-Node-687" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">r</span></span><span id="MJXc-Node-688" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.298em;">≡</span></span><span id="MJXc-Node-689" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span>. An unfortunate attacker who wants to know <span id="MathJax-Element-37-Frame" class="mjx-chtml"><span id="MJXc-Node-690" class="mjx-math" role="math"><span id="MJXc-Node-691" class="mjx-mrow"><span id="MJXc-Node-692" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span> will find that for every possible value of <span id="MathJax-Element-38-Frame" class="mjx-chtml"><span id="MJXc-Node-693" class="mjx-math" role="math"><span id="MJXc-Node-694" class="mjx-mrow"><span id="MJXc-Node-695" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span>, there’s a value <span id="MathJax-Element-39-Frame" class="mjx-chtml"><span id="MJXc-Node-696" class="mjx-math" role="math"><span id="MJXc-Node-697" class="mjx-mrow"><span id="MJXc-Node-698" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span> that will give <span id="MathJax-Element-40-Frame" class="mjx-chtml"><span id="MJXc-Node-699" class="mjx-math" role="math"><span id="MJXc-Node-700" class="mjx-mrow"><span id="MJXc-Node-701" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">r</span></span><span id="MJXc-Node-702" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.298em;">≡</span></span><span id="MJXc-Node-703" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span>. If <span id="MathJax-Element-41-Frame" class="mjx-chtml"><span id="MJXc-Node-704" class="mjx-math" role="math"><span id="MJXc-Node-705" class="mjx-mrow"><span id="MJXc-Node-706" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span id="MJXc-Node-707" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-708" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">4</span></span></span></span></span>, for instance: <span class="math display"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-42-Frame" class="mjx-chtml"><span id="MJXc-Node-709" class="mjx-math" role="math"><span id="MJXc-Node-710" class="mjx-mrow"><span id="MJXc-Node-711" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">4</span></span><span id="MJXc-Node-712" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span id="MJXc-Node-713" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span id="MJXc-Node-714" class="mjx-TeXmathchoice"><span id="MJXc-Node-715" class="mjx-mspace" style="width: 1em; height: 0px;"></span></span><span id="MJXc-Node-716" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-717" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">mod</span></span><span id="MJXc-Node-718" class="mjx-mspace" style="width: 0.333em; height: 0px;"></span><span id="MJXc-Node-719" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">10</span></span><span id="MJXc-Node-720" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span><span id="MJXc-Node-721" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.298em;">≡</span></span><span id="MJXc-Node-722" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span> when <span id="MathJax-Element-43-Frame" class="mjx-chtml"><span id="MJXc-Node-723" class="mjx-math" role="math"><span id="MJXc-Node-724" class="mjx-mrow"><span id="MJXc-Node-725" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span id="MJXc-Node-726" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-727" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">8</span></span></span></span></span>. If <span id="MathJax-Element-44-Frame" class="mjx-chtml"><span id="MJXc-Node-728" class="mjx-math" role="math"><span id="MJXc-Node-729" class="mjx-mrow"><span id="MJXc-Node-730" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span id="MJXc-Node-731" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-732" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">7</span></span></span></span></span>: <span class="math display"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-45-Frame" class="mjx-chtml"><span id="MJXc-Node-733" class="mjx-math" role="math"><span id="MJXc-Node-734" class="mjx-mrow"><span id="MJXc-Node-735" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">7</span></span><span id="MJXc-Node-736" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span id="MJXc-Node-737" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span id="MJXc-Node-738" class="mjx-TeXmathchoice"><span id="MJXc-Node-739" class="mjx-mspace" style="width: 1em; height: 0px;"></span></span><span id="MJXc-Node-740" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-741" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">mod</span></span><span id="MJXc-Node-742" class="mjx-mspace" style="width: 0.333em; height: 0px;"></span><span id="MJXc-Node-743" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">10</span></span><span id="MJXc-Node-744" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span><span id="MJXc-Node-745" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.298em;">≡</span></span><span id="MJXc-Node-746" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span> when <span id="MathJax-Element-46-Frame" class="mjx-chtml"><span id="MJXc-Node-747" class="mjx-math" role="math"><span id="MJXc-Node-748" class="mjx-mrow"><span id="MJXc-Node-749" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span id="MJXc-Node-750" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-751" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">5</span></span></span></span></span>, and so on. Because <span id="MathJax-Element-47-Frame" class="mjx-chtml"><span id="MJXc-Node-752" class="mjx-math" role="math"><span id="MJXc-Node-753" class="mjx-mrow"><span id="MJXc-Node-754" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span> is random, we have no reason to suppose that <span id="MathJax-Element-48-Frame" class="mjx-chtml"><span id="MJXc-Node-755" class="mjx-math" role="math"><span id="MJXc-Node-756" class="mjx-mrow"><span id="MJXc-Node-757" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span> is any particular integer between one and ten, and thus knowing only <span id="MathJax-Element-49-Frame" class="mjx-chtml"><span id="MJXc-Node-758" class="mjx-math" role="math"><span id="MJXc-Node-759" class="mjx-mrow"><span id="MJXc-Node-760" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">r</span></span><span id="MJXc-Node-761" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.298em;">≡</span></span><span id="MJXc-Node-762" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span> gives us no information about what <span id="MathJax-Element-50-Frame" class="mjx-chtml"><span id="MJXc-Node-763" class="mjx-math" role="math"><span id="MJXc-Node-764" class="mjx-mrow"><span id="MJXc-Node-765" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span> is. We can repeat this entire process for as many numbers as we like, allowing us to “transfer” randomness between two arbitrary strings of identical size. We’ve built up a cryptographic system from known primitives in a mathematically sound way- something that’s a recurring motif in cryptography.<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>This non-reusability of keys is why it’s called one-time pad encryption, incidentally.<a href="#fnref4">↩</a></p></li>
<li id="fn5"><p>This was a big somehow.<a href="#fnref5">↩</a></p></li>
<li id="fn6"><p>Technically, Diffie-Hellman only usefully generalizes to finite cyclic groups, and so integer addition, an infinite cyclic group, won’t be very useful. From a pedagogical point of view, however, it’s easier to motivate a computationally asymmetric commutative operation if we have already attained an intuition for the usefulness of commutative/associative operations to key exchange via insecure channels.<a href="#fnref6">↩</a></p></li>
<li id="fn7"><p>We combine a private key, <span id="MathJax-Element-51-Frame" class="mjx-chtml"><span id="MJXc-Node-766" class="mjx-math" role="math"><span id="MJXc-Node-767" class="mjx-mrow"><span id="MJXc-Node-768" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span>, with the group parameter, <span id="MathJax-Element-52-Frame" class="mjx-chtml"><span id="MJXc-Node-769" class="mjx-math" role="math"><span id="MJXc-Node-770" class="mjx-mrow"><span id="MJXc-Node-771" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span></span></span></span>, to get a public key, <span id="MathJax-Element-53-Frame" class="mjx-chtml"><span id="MJXc-Node-772" class="mjx-math" role="math"><span id="MJXc-Node-773" class="mjx-mrow"><span id="MJXc-Node-774" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.024em;">X</span></span></span></span></span>, like this: <span id="MathJax-Element-54-Frame" class="mjx-chtml"><span id="MJXc-Node-775" class="mjx-math" role="math"><span id="MJXc-Node-776" class="mjx-mrow"><span id="MJXc-Node-777" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-778" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-779" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span id="MJXc-Node-780" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-781" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span></span></span></span>.<a href="#fnref7">↩</a></p></li>
<li id="fn8"><p>A binary operator is said to be associative when <span id="MathJax-Element-55-Frame" class="mjx-chtml"><span id="MJXc-Node-782" class="mjx-math" role="math"><span id="MJXc-Node-783" class="mjx-mrow"><span id="MJXc-Node-784" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-785" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span id="MJXc-Node-786" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-787" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-788" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span><span id="MJXc-Node-789" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-790" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-791" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-792" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span id="MJXc-Node-793" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-794" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-795" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-796" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-797" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-798" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span>, that is, the order in which you perform the operations does not change the result.<a href="#fnref8">↩</a></p></li>
<li id="fn9"><p>A binary operator is said to be commutative when <span id="MathJax-Element-56-Frame" class="mjx-chtml"><span id="MJXc-Node-799" class="mjx-math" role="math"><span id="MJXc-Node-800" class="mjx-mrow"><span id="MJXc-Node-801" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span id="MJXc-Node-802" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-803" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-804" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span><span id="MJXc-Node-805" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-806" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">⊙</span></span><span id="MJXc-Node-807" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span>, that is, the order of the operands does not change the result.<a href="#fnref9">↩</a></p></li>
<li id="fn10"><p>Modular exponentiation is indeed commutative, associative, and computationally asymmetric. It’s even more computationally asymmetric than it might seem at first, because there are far more efficient algorithms for performing modular exponentiation than the naive repeated-multiplication-and-take-the-remainder approach.<a href="#fnref10">↩</a></p></li>
<li id="fn11"><p>There’s already an <a href="https://en.wikipedia.org/wiki/Shor%27s_algorithm">efficient quantum algorithm</a> that can calculate discrete logarithms in polynomial time.<a href="#fnref11">↩</a></p></li>
</ol>
</div>

<div class="info">
</div>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.1.6/zepto.min.js"></script>
<script type="text/javascript" src="../css/footnote.js"></script>




        <div id="footer">
          <small>Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a></small>
        </div>
      </div>
    </article>
    </main>
  

</body></html>